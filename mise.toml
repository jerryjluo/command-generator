[tools]
go = "1.25"

[tasks.build]
description = "Build the binary (with embedded web assets)"
depends = ["web-build"]
run = "go build -o cmd ."

[tasks.uninstall]
description = "Remove the globally installed binary and shell integration"
run = """
rm -f ~/.local/bin/cmd
rm -f ~/.config/fish/conf.d/cmd.fish
echo "Removed cmd from ~/.local/bin and fish integration"
"""

[tasks.web-install]
description = "Install web frontend dependencies"
dir = "web"
run = "npm install"

[tasks.web-build]
description = "Build the web frontend"
dir = "web"
run = "npm run build"

[tasks.web-dev]
description = "Start web frontend dev server"
dir = "web"
run = "npm run dev"

[tasks.install]
description = "Build and install CLI globally to ~/.local/bin"
depends = ["web-build"]
run = """
mkdir -p ~/.local/bin
go build -o ~/.local/bin/cmd .
echo "Installed cmd to ~/.local/bin/cmd"
mkdir -p ~/.config/fish/conf.d
cp shell/cmd.fish ~/.config/fish/conf.d/cmd.fish
echo "Installed fish integration to ~/.config/fish/conf.d/cmd.fish"
echo "Restart fish or run: source ~/.config/fish/conf.d/cmd.fish"
"""
