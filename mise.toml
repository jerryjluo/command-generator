[tools]
go = "1.25"

[tasks.build]
description = "Build the binary"
run = "go build -o cmd ."

[tasks.install-cli]
description = "Build and install only the CLI binary to ~/.local/bin"
run = """
mkdir -p ~/.local/bin
go build -o ~/.local/bin/cmd .
echo "Installed cmd to ~/.local/bin/cmd"
echo "Make sure ~/.local/bin is in your PATH"
"""

[tasks.uninstall]
description = "Remove the globally installed binary"
run = """
rm -f ~/.local/bin/cmd
echo "Removed cmd from ~/.local/bin"
"""

[tasks.web-install]
description = "Install web frontend dependencies"
dir = "web"
run = "npm install"

[tasks.web-build]
description = "Build the web frontend"
dir = "web"
run = "npm run build"

[tasks.web-dev]
description = "Start web frontend dev server"
dir = "web"
run = "npm run dev"

[tasks.build-all]
description = "Build both backend and frontend"
run = """
go build -o cmd .
cd web && npm run build
echo "Built both backend and frontend"
"""

[tasks.install]
description = "Build and install CLI + web assets globally to ~/.local/bin"
depends = ["web-build"]
run = """
mkdir -p ~/.local/bin/web
go build -o ~/.local/bin/cmd .
cp -r web/dist ~/.local/bin/web/
echo "Installed cmd to ~/.local/bin/cmd"
echo "Installed web assets to ~/.local/bin/web/dist"
echo "Make sure ~/.local/bin is in your PATH"
"""
